<app-nav></app-nav>
<div class="content">
  <app-header></app-header>
  <div class="workspace">
   <div class="left">
     <mat-card class="details">
       <mat-card-header>
         Class Details
         <span class="spacer"></span>
         <mat-select placeholder="Class" [(value)]="selectedClass" *ngIf="!create">
           <mat-option *ngFor="let cls of classes;let i=index" [value]="i">{{cls.name}}</mat-option>
         </mat-select>
         <mat-chip-listbox>
           <mat-chip [ngStyle]="{'background-color':create ? '#3f51b5' : 'lightgrey','transition':'150ms ease-out'}" (click)="createToggle()">
             <mat-icon [ngStyle]="{'color':create ? 'white' : 'black'}">add</mat-icon>
           </mat-chip>
         </mat-chip-listbox>
       </mat-card-header>
       <mat-card-content *ngIf="!create" class="allocation-form">
         <table>
           <tr>
             <td class="width">Class Teacher</td>
             <td>{{findTeacherName(classes[selectedClass].teacherID)}}</td>
           </tr>
           <tr>
             <td>Allocated Date</td>
             <td>{{classes[selectedClass].allocatedDate | date:'dd/mm/yyyy'}}</td>
           </tr>
           <tr>
             <td>Girls</td>
             <td>{{classes[selectedClass].girlsCount}}</td>
           </tr>
           <tr>
             <td>Boys</td>
             <td>{{classes[selectedClass].boysCount}}</td>
           </tr>
           <tr>
             <td>Total Students</td>
             <td>{{classes[selectedClass].girlsCount+classes[selectedClass].boysCount}}</td>
           </tr>
         </table>
       </mat-card-content>
       <mat-card-content *ngIf="create">
         <mat-form-field appearance="outline" class="width top-margin">
           <mat-label>Enter Class Name</mat-label>
           <input matInput placeholder="E.g. 6A" [(ngModel)]="newClass">
         </mat-form-field>
       </mat-card-content>
       <mat-card-actions *ngIf="create" align="end">
         <button mat-raised-button (click)="createClass(newClass);createToggle()">Create</button>
         <button mat-raised-button (click)="createToggle()">Discard</button>
       </mat-card-actions>
     </mat-card>
   </div>
    <div class="right">
      <mat-card class="allocation">
        <mat-card-header>
          Class Allocation
          <span class="spacer"></span>
          <mat-chip-listbox>
            <mat-chip [ngStyle]="{'background-color':modify ? '#3f51b5' : 'lightgrey','transition':'150ms ease-out'}" (click)="modifyToggle()">
              <mat-icon [ngStyle]="{'color':modify  ? 'white' : 'black'}">create</mat-icon>
            </mat-chip>
          </mat-chip-listbox>
        </mat-card-header>
        <mat-card-content>
          <div *ngFor="let cls of (modify ? tempClasses:classes)">
            <div class="allocate-entry">
              Class {{cls.name}}
              <span class="spacer"></span>
              <mat-select [placeholder]="modify ? 'Select a Teacher':'Not Allocated'"
                          [(value)]="cls.teacherID"
                          (valueChange)="getSelectedTeacher()"
                          [ngStyle]="{'background-color':cls.teacherID == 0 ?'lightgrey' : 'blue'}"
                          [disabled]="!modify" [ngClass]="{'hide':!modify}">
                <mat-option [value]=0 class="remove">Remove Selection</mat-option>
                <mat-option *ngFor="let teacher of teachers" [value]="teacher.id" [disabled]="selectedTeachers.includes(teacher.id)">
                  {{teacher.name}}
                </mat-option>
              </mat-select>
            </div>
            <mat-divider></mat-divider>
          </div>
        </mat-card-content>
        <mat-card-actions align="end" *ngIf="modify">
          <button mat-raised-button (click)="modifyToggle();allocate()">Allocate</button>
          <button mat-raised-button (click)="modifyToggle()">Discard</button>
        </mat-card-actions>
      </mat-card>
    </div>
  </div>
</div>
