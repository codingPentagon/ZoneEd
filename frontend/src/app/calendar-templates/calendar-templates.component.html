<mat-card>
  <mat-card-header>
    {{disableCreation ? 'Calendar Approval Requests' : 'Calendar Templates'}}
    <span class="spacer"></span>
    <span *ngIf="!disableCreation" class="flex gap">
      <mat-icon (click)="createToggle()" [ngClass]="{active:create}">create</mat-icon>
      <mat-icon (click)="deleteToggle()" [ngClass]="{active:delete}">delete</mat-icon>
    </span>
  </mat-card-header>
  <mat-card-content class="" *ngIf="!create">
    <mat-accordion>
      <mat-expansion-panel *ngFor="let template of templates" [ngClass]="{selected:selectedTemplate==template}">
        <mat-expansion-panel-header (click)="selectedTemplate=template">
          <mat-panel-title>
            {{template.name}}
          </mat-panel-title>
          <mat-panel-description>
            {{disableCreation ? template.sclID:template.status}}
          </mat-panel-description>
        </mat-expansion-panel-header>
        <mat-action-row *ngIf="!disableCreation && template.status.toLowerCase()=='not submitted'">
          <button mat-raised-button (click)="submitTemplate()">Submit</button>
        </mat-action-row>
        <mat-action-row *ngIf="disableCreation && template.status.toLowerCase()=='pending'">
          <button mat-raised-button (click)="updateApproval(true)">Approve</button>
          <button mat-raised-button (click)="updateApproval(false)">Reject</button>
        </mat-action-row>
        <mat-action-row *ngIf="!disableCreation && template.status.toLowerCase()=='approved'">
          <button mat-raised-button (click)="makeActive()">Make Active Calendar</button>
        </mat-action-row>
      </mat-expansion-panel>
    </mat-accordion>
  </mat-card-content>
  <mat-card-content *ngIf="create">
    <form id="new-template" #newTemplate="ngForm" ngForm (ngSubmit)="createTemplate(newTemplate)">
      <mat-form-field class="full-width" appearance="outline">
        <mat-label>Template Name</mat-label>
        <input matInput placeholder="2023 v1" name="name" ngModel required>
      </mat-form-field>
      <mat-form-field class="full-width" appearance="outline">
        <mat-label>Year</mat-label>
        <input matInput placeholder="2023" name="sclID" ngModel required>
      </mat-form-field>
    </form>
  </mat-card-content>
  <mat-card-actions *ngIf="create || delete" align="end">
    <button *ngIf="create" mat-raised-button form="new-template" type="submit">Create</button>
    <button *ngIf="delete" mat-raised-button (click)="deleteTemplate()">Delete</button>
    <button mat-raised-button (click)="create=delete=false">Cancel</button>
  </mat-card-actions>
</mat-card>
